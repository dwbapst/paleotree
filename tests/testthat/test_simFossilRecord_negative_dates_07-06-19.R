test_that("simFossilRecord doesn't produce negative dates", {

library(paleotree)

saved_seed <- c(
10403L, 571L, -1853698735L, -1617683795L, 1433983323L, 1602013699L, 
-2139602443L, 828740635L, 810136674L, -222442686L, -1062350433L, 
-279344709L, -2137247395L, -966848151L, -488751592L, -1706372736L, 
-462208098L, 2108738791L, 1854509369L, -1307471181L, 1824146925L, 
1513717001L, 275256421L, -1846634309L, -833859483L, -734561029L, 
1042021435L, 809711929L, 419243244L, -802286761L, 1497007147L, 
81557787L, -660252751L, -97986758L, -1448549103L, -1958553833L, 
2138156950L, 1516137314L, -1055500571L, 1731328840L, -224850824L, 
578689076L, 75625678L, -1737530033L, -1970920588L, 655890861L, 
1915360703L, -2005923087L, 465893075L, -987497959L, -1961535427L, 
-1630816780L, -2054701103L, 1923176537L, -615338329L, 903476606L, 
1020325941L, -1477321166L, 1366880540L, 461923545L, 911670059L, 
456674787L, 1757261593L, -214157451L, 23884317L, -61834478L, 
-1284939658L, 60821190L, 1290224258L, 1637433497L, 1829748002L, 
-1496828380L, -1589954927L, -431184785L, -98000072L, 1734108228L, 
-1060726931L, 1424209627L, -492293930L, 1827255675L, -1515697483L, 
1705432642L, -654919731L, 479249862L, -642548399L, 463517046L, 
1437299327L, -661009978L, -545419484L, 1095205387L, 1204985906L, 
60112567L, 747657768L, 1363495870L, -619584692L, -669186361L, 
852912097L, 665320879L, -671271289L, 1086304910L, -2071286025L, 
-1383204603L, -2113284666L, 1775147647L, -1408585778L, 2079737639L, 
615561733L, 73689641L, 1337836445L, -122174301L, 706428174L, 
1602647067L, 124432173L, 1689693158L, 29308779L, -1124538333L, 
298880120L, -1649708682L, -955015679L, 1315162081L, -462518049L, 
2013666168L, 696045019L, 390286924L, 1076310877L, -1361451743L, 
-1665344435L, 1837707039L, 163101988L, 1829851039L, -2066823469L, 
-90204041L, 1814667675L, -457052526L, 123341287L, 463472256L, 
-1430167168L, 301112184L, 1723064924L, -1159489234L, 1076843039L, 
-1132661112L, 27798743L, -1975550119L, -1008435513L, -1504805619L, 
-1676524544L, -354669894L, 1138748432L, -561934610L, 1914366784L, 
-1982489914L, -1357599160L, -1938070906L, -1806154290L, -1094073373L, 
2087859816L, 1110103573L, 2025907443L, -379404128L, -1174067044L, 
-1267612669L, 1573604445L, 1001623553L, -135456734L, -1575261349L, 
-1815750733L, -1018860996L, -436036596L, -2138189894L, 250540748L, 
910620079L, 297999721L, -787324315L, 607555736L, -11846095L, 
-1836666190L, 2000222791L, -155347258L, 88808049L, 508040486L, 
-448013317L, -211033215L, 2042103042L, 1649670458L, 2045553063L, 
-16545087L, -1668583180L, 1946719758L, 781884963L, 696941254L, 
919544888L, 1471648712L, 549978839L, 1889953923L, 1640331206L, 
-1764565144L, 277868371L, 1655843748L, -1949612026L, 1993309602L, 
-1700497328L, 846105420L, -709770589L, 1802532037L, -1608245964L, 
474706330L, -1589153638L, -698466802L, -1990683508L, -1648915059L, 
-518663001L, -1056118794L, 424234687L, 856322830L, -1258942958L, 
869424139L, -445077723L, -973033739L, 1276005716L, -247957612L, 
1239547611L, 1574788792L, -854735167L, 1289734935L, 852943523L, 
1296864790L, -133808582L, -216284195L, 879457686L, -1377906328L, 
1597715383L, -1765177183L, 482511652L, -1211171858L, -1672126265L, 
533761940L, -736680301L, -1584136012L, -2058234427L, 1122491067L, 
-1312521127L, -1322337215L, -797826844L, -36248282L, -432167968L, 
-1542279032L, -2078621936L, 1483903132L, -2146889202L, 231610347L, 
2141070295L, 1129857719L, -1062243101L, 1500707757L, -2086555059L, 
-492347650L, -1756441812L, -799029007L, 643260017L, 1081037763L, 
-995194269L, -744808703L, -300509415L, 805434156L, 1417125810L, 
1688950459L, -647830294L, -318983034L, 1472091132L, 1284145290L, 
438409963L, 1039086804L, -1329068550L, 1475391745L, 743261523L, 
1844477472L, -948242021L, 2051359923L, 1853483022L, -602159388L, 
-200059860L, 1966119739L, 2094190721L, -1852317829L, 530993408L, 
-1476986008L, -847875145L, 909813623L, -1439558460L, 1411827320L, 
349167711L, 172282929L, 1644103834L, -590876338L, 1223027271L, 
-537116176L, -1210458223L, 1908648705L, 1394227509L, -74821458L, 
2087266771L, 47978638L, 792460695L, -1265557208L, -80134366L, 
1232891816L, 1611714571L, 1020846137L, 773016345L, 1617766307L, 
-1235879317L, 1895391305L, 169233468L, -1258775487L, -1461443236L, 
-1906564258L, -933806533L, -1461390823L, 1916731630L, -731894006L, 
1922128305L, -1294909155L, -1490264410L, -1433634674L, -132189123L, 
-633352314L, 1217080486L, 1278041233L, 160642529L, 2055737957L, 
-2035578178L, 498491404L, 1860733850L, -1545521305L, 673391474L, 
-1944192042L, -762553878L, -1336312142L, 1232118406L, 1955124317L, 
-1870118377L, -1127308999L, -172897011L, -1224248334L, -1776683384L, 
-922118073L, -49032017L, 1692435451L, -857936441L, -1769584363L, 
-1475906502L, -1496298326L, 270862639L, 940687450L, -1326161823L, 
2062695569L, 436014856L, -1803713131L, -424225252L, 797426765L, 
393691671L, -673601349L, 531454110L, -1225646598L, -235716991L, 
-1865330947L, 1263335694L, -1264999834L, -670156227L, 196235768L, 
426497556L, -1369999781L, -522140111L, 1592919051L, 1639184800L, 
1012881521L, 1138772221L, 424715353L, 666399614L, 974715248L, 
-712772579L, -661399666L, 2002771233L, -425412621L, 1304477587L, 
-1742662538L, -869915638L, -1383823571L, -860162588L, 163863576L, 
-1683806652L, 1091419704L, -775859408L, -62549785L, -162207709L, 
-353924515L, 620454336L, -1245118640L, 1905653577L, 636261242L, 
-1596437293L, 16449432L, -1691767447L, 1348172727L, -1384311936L, 
1125393544L, -2072848942L, 713008419L, 742054253L, -1476661401L, 
843793876L, -1284451103L, 1221778685L, 902272468L, -218093693L, 
1597593062L, -1323665945L, -1641685136L, 2096268918L, -1151974505L, 
-1966507230L, -2142822395L, 1365160752L, 1562929423L, -971159986L, 
982929974L, -943681632L, -655961415L, -1113726106L, 821777900L, 
-1936930352L, 1658389807L, -1480587857L, 1810373062L, 1610187420L, 
-1061552600L, 1845170423L, 1659752482L, 1977364133L, -2067258745L, 
1988951973L, -2014122681L, -1542221550L, -1160666994L, -905249898L, 
-1350605932L, 297765417L, -427768077L, -1468684165L, 884615840L, 
-2061673235L, 1844719662L, -1158590253L, -1572328378L, -640196980L, 
919524830L, -577017372L, 1257573538L, -556445104L, 1271285357L, 
21657835L, 1194448631L, -1270375187L, 1227184612L, -697506L, 
-750946175L, 936751255L, 487023160L, 1339140426L, 1129432116L, 
745934588L, 827759462L, 1487497420L, -730778558L, -1676435491L, 
-808592782L, -285203312L, -166055190L, 1501951550L, 66472998L, 
-589611882L, 1998712821L, -308880320L, 1242288438L, 2060022343L, 
998675296L, -953336964L, 1036916920L, -290148209L, -850088204L, 
1053428966L, 424423530L, 1220326178L, 456053541L, 61604734L, 
-1953344484L, 619188727L, 440896579L, -2013706738L, -2043450736L, 
-84513113L, 1237269073L, -594001374L, 1018541669L, 122526729L, 
1762858799L, 609160311L, 141995178L, 224443233L, -1020010147L, 
192517030L, -2090136902L, -1491007030L, -456193341L, -1415919708L, 
1073127930L, -514912680L, 1815086148L, -12998123L, -1480420701L, 
387063727L, 1636959551L, -2128380953L, -395012474L, 1840629665L, 
936331776L, -424264728L, -181232011L, 1523099133L, -1473420234L, 
-1722394862L, -1188569071L, -1822663880L, 455731667L, -1116163407L, 
-1184463873L, 709462160L, -102575007L, 2023507857L, -1152626809L, 
1507025682L, -1810804074L, 754430500L, 1253840337L, -1283465938L, 
1909853053L, -517508315L, 1385022721L, -130431013L, 823102562L, 
-483524280L, -1176901917L, 2026469711L, -680898713L, 948804489L, 
-513523886L, 388724366L, -1732770673L, -1824387128L, -797827748L, 
1942468467L, -1305606244L, -1706830508L, 1795512931L, -934665508L, 
1981531473L, 1457743656L, 836767629L, -123389583L, 1415885779L, 
745320262L, 599784800L, -857165284L, -1164506705L, 1234223610L, 
21605988L, -675791210L, -1216791157L, -692101884L, 660234683L, 
1803226399L, -683833859L, 35139070L, -639158710L, 13069439L, 
-1617037945L, 1582373318L, -567721642L, 2090187424L, 890488569L, 
-978532023L, 1145450893L, 530946503L, -1357110337L, -1119543141L, 
1864871195L, -212985630L, 1132921875L, -581074538L, 1040283510L, 
1232269288L, 858962061L, 496032078L, -1700434939L, -1259189619L, 
2110196018L, -1015246932L, 1805885105L, -1645832437L, 1000860821L, 
-693011612L, -843431922L, -242650762L, -558676179L, -1256790071L, 
800396782L, -1748206454L, -555738314L, -1512478199L, 1947141636L, 
1852784704L, -6829052L, -1614695797L, 1610126043L, 1677797671L
)

.Random.seed <- saved_seed

record <- simFossilRecord(
	p = 1/0.97,
	q = 1/0.97, 
	r = 1/0.97, 
	nruns = 1,
	# controls
	totalTime = c(0, 1000), 
	nTotalTaxa = c(1, 1000),
	# basically only conditioned on at least 1 extant taxon
	nExtant = c(1, 1000),
	# and 10 to 100 sampled fossil taxa
	nSamp = c(10,100),
	plot = TRUE
	)

testRes <- checkRecordForNoDatePastZero(fossilRecord = record)

if(!testRes){
	stop("checkRecordForNoDatePastZero returned FALSE")
	}
})
