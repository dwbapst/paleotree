#NEXUS
BEGIN DATA;
dimensions nchar=50 ntax= 26 ;
FORMAT DATATYPE=STANDARD GAP=- MISSING=?;
matrix

Parabolinella_prolata_Fint                 00---?000011?0100100022010020?00??110010??????????
Parabolinella_prolata_Lint                 00---?000011?0100100022010020?00??110010??????????
Parabolinella_tumifrons_Fint               21?00?01100110100100022010020?00??11001???????????
Parabolinella_tumifrons_Lint               21?00?01100110100100022010020?00??11001???????????
Balnibarbi_scimitar_Fint                    110004302010000010121220101101101?1011012320101001
Balnibarbi_scimitar_Lint                    110004302010000010121220101101101?1011012320101001
Balnibarbi_ceryx_ceryx_Fint                  01000?002110?00010121?2011111110?1101101221111?000
Balnibarbi_ceryx_ceryx_Lint                  01000?002110?00010121?2011111110?1101101221111?000
Balnibarbi_ceryx_anataphra_Fint                  21000?40?110?00?1012122010110?111?10????22101??000
Balnibarbi_ceryx_anataphra_Lint                  21000?40?110?00?1012122010110?111?10????22101??000
Balnibarbi_sombrero_Fint                    11200?312110?01?1012122011210?00??10110112111?0010
Balnibarbi_sombrero_Lint                    11200?312110?01?1012122011210?00??10110112111?0010
Cloacaspis_dejecta_Fint                11210?11021201100112111010210?00?11011001110101110
Cloacaspis_dejecta_Lint                11210?11021201100112111010210?00?11011001110101110
Balnibarbi_pulvurea_Fint            01101?0002120?100012111010210?00?1101100??????????
Balnibarbi_pulvurea_Lint            01101?0002120?100012111010210?00?1101100??????????
Balnibarbi_erugata_Fint                   11210?410212001111220000112100100?1020100100111110
Balnibarbi_erugata_Lint                   11210?410212001111220000112100100?1020100100111110
Balnibarbi_tholia_Fint                     01000?4112121011011101?011210?10??10??????001??100
Balnibarbi_tholia_Lint                     01000?4112121011011101?011210?10??10??????001??100
Cloacaspis_ekphymosa_Fint                    01101?41020100200111000011210?00?010?0000100100110
Cloacaspis_ekphymosa_Lint                    01101?41020100200111000011210?00?010?0000100100110
Cloacaspis_senilis_Fint                   01101?01020100200111000011210?00?010??????????????
Cloacaspis_senilis_Lint                   01101?01020100200111000011210?00?010??????????????
Cloacaspis_tesselata_Fint                   21200?01020100200111001011210?00?010?1101100100110
Cloacaspis_tesselata_Lint                   21200?01020100200111001011210?00?010?1101100100110

;
end;

begin mrbayes;

[This block is a combination of best practices taken from NEXUS files from April Wright,
     William Gearty, Graham Slater, Davey Wright, and guided by the 
	 recommendations of Matzke and Wright, 2016, Biol. Lett.]

[no autoclose, I like it to ask, but you might want it]
	[set autoclose = yes;]

log start filename = "balnibarbinae_mrB_tip-dating_08-13-18.nex.out" replace;

[DATA]

[edits to taxon or character selection go here]
			
[CONSTRAIN MONOPHYLY OF INGROUP]

	[constrain all members of the ingroup to be monophyletic]

constraint ingroup = Parabolinella_tumifrons_Fint Parabolinella_tumifrons_Lint Balnibarbi_scimitar_Fint Balnibarbi_scimitar_Lint Balnibarbi_ceryx_ceryx_Fint Balnibarbi_ceryx_ceryx_Lint Balnibarbi_ceryx_anataphra_Fint Balnibarbi_ceryx_anataphra_Lint Balnibarbi_sombrero_Fint Balnibarbi_sombrero_Lint Cloacaspis_dejecta_Fint Cloacaspis_dejecta_Lint Balnibarbi_pulvurea_Fint Balnibarbi_pulvurea_Lint Balnibarbi_erugata_Fint Balnibarbi_erugata_Lint Balnibarbi_tholia_Fint Balnibarbi_tholia_Lint Cloacaspis_ekphymosa_Fint Cloacaspis_ekphymosa_Lint Cloacaspis_senilis_Fint Cloacaspis_senilis_Lint Cloacaspis_tesselata_Fint Cloacaspis_tesselata_Lint;
prset topologypr = constraints(ingroup);
	
[TOPOLOGICAL CONSTRAINTS FOR ADDITIONAL NODES]

	[[EXAMPLE]
    constraint node1 = t1 t2 t3;
    constraint node2 = t4 t5;
	prset topologypr = constraints(ingroup,node1,node2); [need to include ingroup]]

 
  
[ordered characters block]
ctype ordered: 1 15 20;



[CHARACTER MODELS]
	
[morphology model settings]
	[make the number of beta categories for stationary frequencies 4 (the default)]
	[default: use pars-informative coding]
	
	[set coding and rates - default below maximizes information content]
		lset  nbetacat = 5 rates = equal Coding = informative; [equal rate variation]
		[lset  nbetacat = 5 rates = gamma Coding = informative;   [gamma distributed rate variation]]
			[gamma distributed rates may cause divide by zero problems with non-fixed symdiri]
	[symdirhyperpr prior, fixed vs. variable]	
		prset symdirihyperpr = fixed(infinity);		
		[prset symdirihyperpr = uniform(1,10);      [this range seems to avoid divide by zero error]]



[TIP AND TREE AGE CALIBRATIONS] 
	
		[[EXAMPLE WITH BOUNDS: min age, max age]	
		calibrate t1 = uniform(105, 113);
		calibrate t2 = uniform(97, 115);
		[EXAMPLE WITH FIXED AGE]
		calibrate t3 = fixed (100);]
	
	[prior on tree age]
	[with offset exponential in MrB, first par is min age, second is expected mean age]
		[mean date must be greater than min date - duh]
		
		[EXAMPLE]
		[prset treeagepr = offsetexp(115,120); ]
			

calibrate Parabolinella_prolata_Fint = fixed (486.75);
calibrate Parabolinella_prolata_Lint = fixed (483);
calibrate Parabolinella_tumifrons_Fint = fixed (486.75);
calibrate Parabolinella_tumifrons_Lint = fixed (483);
calibrate Balnibarbi_scimitar_Fint = fixed (473.83);
calibrate Balnibarbi_scimitar_Lint = fixed (473.83);
calibrate Balnibarbi_ceryx_ceryx_Fint = fixed (473.81);
calibrate Balnibarbi_ceryx_ceryx_Lint = fixed (473.45);
calibrate Balnibarbi_ceryx_anataphra_Fint = fixed (473.78);
calibrate Balnibarbi_ceryx_anataphra_Lint = fixed (473.69);
calibrate Balnibarbi_sombrero_Fint = fixed (473.59);
calibrate Balnibarbi_sombrero_Lint = fixed (473.03);
calibrate Cloacaspis_dejecta_Fint = fixed (473.34);
calibrate Cloacaspis_dejecta_Lint = fixed (472.34);
calibrate Balnibarbi_pulvurea_Fint = fixed (473.23);
calibrate Balnibarbi_pulvurea_Lint = fixed (471.93);
calibrate Balnibarbi_erugata_Fint = fixed (472.92);
calibrate Balnibarbi_erugata_Lint = fixed (471.82);
calibrate Balnibarbi_tholia_Fint = fixed (471.9);
calibrate Balnibarbi_tholia_Lint = fixed (471.52);
calibrate Cloacaspis_ekphymosa_Fint = fixed (471.1);
calibrate Cloacaspis_ekphymosa_Lint = fixed (470.69);
calibrate Cloacaspis_senilis_Fint = fixed (470.69);
calibrate Cloacaspis_senilis_Lint = fixed (470);
calibrate Cloacaspis_tesselata_Fint = fixed (470.5);
calibrate Cloacaspis_tesselata_Lint = fixed (468);

prset treeagepr = offsetexp(486.75, 496.75);
	
[FOSSILIZED BIRTH DEATH MODEL & ASSOCIATED PARAMETERS]

    prset brlenspr = clock:fossilization;
	prset fossilizationpr = beta(1,1); [flat, sampling is psi/(mu+psi), 0-1 ]

    prset speciationpr = uniform(0,10);
	prset extinctionpr = beta(1,1); [flat, extinction is relative to speciation between 0-1]

	prset samplestrat = random; [default: bdss prior ]
	[prset samplestrat = fossiltip; [this would mean no sampled ancestors]]
	
	prset sampleprob = 1; [rho, sampling in the present, default fixed to 1]
	[Unclear what to set this to if all taxa are extinct...]
	
[CLOCK PRIORS]
	
	[clock rate: truncated normal, mean = 0.08, but very flat; see Supp Table 2 of Matzke & Wright 2016]
    prset clockratepr = normal(0.0025,0.1);     
	prset clockvarpr = igr;
    prset igrvarpr = uniform(0.0001, 200); [vague prior that is actually vague; Matzke & Wright 2016]

	prset nodeagepr = calibrated; [set node age priors]
	
[SETTINGS FOR PARTITIONED ANALYSES]

	[Necessary if a combined analysis, I guess]

[RUN SETTINGS]

[FYI burnin settings for one command sets burnin settings for all]
	mcmcp ngen = 100000 relburnin = yes burninfrac = 0.5 printfreq = 1000 samplefreq = 1000 nchains = 4 nruns = 2 savebrlens = yes;    
	set seed = 4;

	

[RUN]
	mcmc;
	sump;
	
	[Given this is a dating analysis, should really use MCCT,not summary trees]
		[I guess best summary tree though is allcompat?]
	[sumt contype = allcompat; ]    [allcompat has issues with sampled ancestors]
	
	log stop;

 
end;
